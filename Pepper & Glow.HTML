<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Pepper & Glow — Boutique</title>
  <meta name="description" content="Commander des soins naturels à base de piment du Cap Bon — Pepper & Glow" />
  <style>
    :root{--bg:#fafaf8;--card:#fff;--accent:#c94b37;--accent-2:#ff7b4a;--muted:#6b6b6b;--glass:rgba(255,255,255,0.6)}
    *{box-sizing:border-box}
    body{font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, Arial; margin:0;background:linear-gradient(180deg,#fbfbfa,#f7fff5);color:#111}
    .wrap{max-width:1100px;margin:28px auto;padding:18px}
    header{display:flex;align-items:center;gap:16px;margin-bottom:18px}
    .logo{display:flex;align-items:center;gap:10px}
    .logo .mark{width:52px;height:52px;border-radius:10px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;color:white;font-weight:800}
    h1{margin:0;font-size:20px}
    p.lead{margin:0;color:var(--muted);font-size:14px}

    .main{display:grid;grid-template-columns:1fr 360px;gap:20px}
    @media (max-width:980px){.main{grid-template-columns:1fr}.cart-panel{order:-1}}

    .catalog{display:grid;grid-template-columns:repeat(2,1fr);gap:14px}
    @media (max-width:680px){.catalog{grid-template-columns:1fr}}

    .card{background:var(--card);border-radius:12px;padding:14px;box-shadow:0 6px 24px rgba(16,24,40,0.06)}
    .product-img{width:100%;height:160px;border-radius:8px;display:flex;align-items:center;justify-content:center;background:linear-gradient(180deg,#fff,#fff7f2);color:#c95a44;font-weight:700}
    .product-title{font-weight:700;margin:8px 0 6px}
    .price{font-size:16px;color:var(--accent-2);font-weight:800}
    .meta{font-size:13px;color:var(--muted)}
    .controls{display:flex;gap:8px;align-items:center;margin-top:10px}
    .controls button{background:var(--accent);color:white;border:none;padding:8px 10px;border-radius:8px;cursor:pointer}
    .controls .qty{display:flex;align-items:center;gap:8px}
    input[type="number"]{width:64px;padding:6px;border-radius:8px;border:1px solid #eee}

    .cart-panel{position:relative}
    .cart{position:sticky;top:18px;background:var(--card);padding:16px;border-radius:12px;box-shadow:0 6px 24px rgba(16,24,40,0.06)}
    .cart h3{margin:0 0 8px}
    .cart-list{max-height:300px;overflow:auto;margin-bottom:10px}
    .cart-item{display:flex;gap:10px;align-items:center;padding:8px 0;border-bottom:1px dashed #f0f0f0}
    .cart-item:last-child{border-bottom:0}
    .cart-item .meta{font-size:13px}
    .totals{display:flex;justify-content:space-between;font-weight:700;margin-top:8px}
    .checkout{margin-top:12px;display:grid;gap:10px}
    .checkout input, .checkout textarea, .checkout select{width:100%;padding:10px;border:1px solid #eee;border-radius:8px}
    .btn-primary{background:var(--accent-2);color:white;border:none;padding:12px;border-radius:10px;font-weight:800;cursor:pointer}
    .btn-secondary{background:transparent;border:1px solid #eee;padding:10px;border-radius:10px;cursor:pointer}

    footer{text-align:center;margin-top:18px;color:var(--muted);font-size:13px}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">
        <div class="mark">P&G</div>
        <div>
          <h1>Pepper & Glow — Boutique</h1>
          <p class="lead">Soins naturels à base du piment du Cap Bon — cheveux & lèvres</p>
        </div>
      </div>
    </header>

    <div class="main">
      <div>
        <section class="catalog" id="catalog">
          <!-- Product cards générés par JS -->
        </section>

        <div style="margin-top:14px;display:flex;gap:10px">
          <button class="btn-secondary" onclick="clearCart()">Vider le panier</button>
          <button class="btn-secondary" onclick="prefillDemo()">Remplir démo</button>
        </div>
      </div>

      <aside class="cart-panel">
        <div class="cart card">
          <h3>Panier</h3>
          <div class="cart-list" id="cartList">
            <div class="meta">Votre panier est vide.</div>
          </div>
          <div class="totals"><span>Sous‑total</span><span id="subtotal">0 TND</span></div>

          <div class="checkout">
            <input type="text" id="clientName" placeholder="Nom (optionnel pour anonymat)" />
            <input type="text" id="clientAddress" placeholder="Adresse de livraison" />
            <input type="tel" id="clientPhone" placeholder="Téléphone" />
            <select id="deliveryMethod">
              <option value="standard">Retrait local (Nabeul) — Gratuit</option>
              <option value="domicile">Livraison à domicile — 3 TND</option>
            </select>
            <textarea id="note" placeholder="Instructions / Allergies / Remarques (optionnel)"></textarea>
            <button class="btn-primary" onclick="checkout()">Passer commande</button>
            <button class="btn-secondary" onclick="downloadCart()">Télécharger le récap. (JSON)</button>
          </div>
        </div>
      </aside>
    </div>

    <footer>© Pepper & Glow — Projet étudiant · Cap Bon (Nabeul)</footer>
  </div>

  <script>
    // Catalogue initial
    const products = [
      {id: 'h01', title: 'Huile capillaire Piment & Romarin — 50ml', price: 18, desc: 'Huile naturelle pour cheveux secs et abîmés. Nourrit, fait briller.'},
      {id: 'h02', title: 'Masque réparateur Piment — 120ml', price: 30, desc: 'Masque profond à base de piment et argan pour réparation intensive.'},
      {id: 'l01', title: 'Baume à lèvres Piment doux — 8g', price: 9, desc: 'Baume hydratant, non collant, au parfum léger.'},
      {id: 'l02', title: 'Gommage lèvres Piment & Sucre — 25g', price: 7, desc: 'Exfolie en douceur pour lèvres douces et lisses.'}
    ];

    // Etat du panier
    let cart = {};

    function formatPrice(v){ return v + ' TND'; }

    // Génération du catalogue
    const catalogEl = document.getElementById('catalog');
    products.forEach(p => {
      const card = document.createElement('article'); card.className='card';
      card.innerHTML = `
        <div class="product-img">${p.title.split(' ')[0]}</div>
        <div>
          <div class="product-title">${p.title}</div>
          <div class="meta">${p.desc}</div>
          <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px">
            <div class="price">${formatPrice(p.price)}</div>
            <div class="controls">
              <div class="qty"><input type="number" min="1" value="1" id="qty-${p.id}" /></div>
              <button onclick="addToCart('${p.id}')">Ajouter</button>
            </div>
          </div>
        </div>
      `;
      catalogEl.appendChild(card);
    });

    function addToCart(id){
      const qtyInput = document.getElementById('qty-'+id);
      const qty = Math.max(1, parseInt(qtyInput.value || 1));
      const prod = products.find(x=>x.id===id);
      if(!prod) return;
      if(cart[id]) cart[id].qty += qty; else cart[id] = { ...prod, qty };
      renderCart();
    }

    function renderCart(){
      const list = document.getElementById('cartList');
      list.innerHTML = '';
      const keys = Object.keys(cart);
      if(keys.length===0){ list.innerHTML = '<div class="meta">Votre panier est vide.</div>'; document.getElementById('subtotal').textContent='0 TND'; return; }
      let subtotal = 0;
      keys.forEach(k=>{
        const it = cart[k];
        const item = document.createElement('div'); item.className='cart-item';
        item.innerHTML = `
          <div style="flex:1">
            <div style="font-weight:700">${it.title}</div>
            <div class="meta">${it.qty} × ${formatPrice(it.price)}</div>
          </div>
          <div style="text-align:right">
            <div style="font-weight:800">${formatPrice(it.qty*it.price)}</div>
            <div style="margin-top:6px;display:flex;gap:6px;justify-content:flex-end">
              <button onclick="changeQty('${k}', -1)">−</button>
              <button onclick="changeQty('${k}', 1)">+</button>
              <button onclick="removeItem('${k}')">Suppr</button>
            </div>
          </div>
        `;
        list.appendChild(item);
        subtotal += it.qty * it.price;
      });
      // delivery cost
      const delivery = document.getElementById('deliveryMethod')?.value === 'domicile' ? 3 : 0;
      document.getElementById('subtotal').textContent = formatPrice(subtotal + delivery);
    }

    function changeQty(id, delta){
      if(!cart[id]) return;
      cart[id].qty += delta;
      if(cart[id].qty <= 0) delete cart[id];
      renderCart();
    }
    function removeItem(id){ delete cart[id]; renderCart(); }

    function clearCart(){ if(confirm('Vider le panier ?')){ cart = {}; renderCart(); } }

    function checkout(){
      const keys = Object.keys(cart);
      if(keys.length===0){ alert('Votre panier est vide.'); return; }
      const name = document.getElementById('clientName').value.trim();
      const address = document.getElementById('clientAddress').value.trim();
      const phone = document.getElementById('clientPhone').value.trim();
      const note = document.getElementById('note').value.trim();
      const delivery = document.getElementById('deliveryMethod').value;

      if(!address && delivery==='domicile'){ alert('Veuillez indiquer une adresse pour la livraison.'); return; }
      if(!phone){ if(!confirm('Vous n\'avez pas indiqué de téléphone — continuer ?')) return; }

      const order = {
        id: 'PG-' + Date.now(), date: new Date().toISOString(), name, address, phone, note, delivery,
        items: Object.values(cart).map(i=>({id:i.id,title:i.title,qty:i.qty,price:i.price})),
      };

      // Simuler enregistrement (ici console puis téléchargement du récapitulatif)
      console.log('Commande simulée :', order);
      alert('Merci ! Votre commande a été simulée. Un fichier récapitulatif va être téléchargé.');
      // télécharger JSON
      const blob = new Blob([JSON.stringify(order, null, 2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = order.id + '.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);

      // Reset
      cart = {};
      renderCart();
      document.getElementById('clientName').value='';
      document.getElementById('clientAddress').value='';
      document.getElementById('clientPhone').value='';
      document.getElementById('note').value='';
    }

    function downloadCart(){
      const order = { items: Object.values(cart), date: new Date().toISOString() };
      const blob = new Blob([JSON.stringify(order, null, 2)], {type:'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a'); a.href = url; a.download = 'panier_pepper_and_glow.json'; document.body.appendChild(a); a.click(); a.remove(); URL.revokeObjectURL(url);
    }

    function prefillDemo(){
      cart = {};
      cart['h01'] = {...products[0], qty:1};
      cart['l01'] = {...products[2], qty:2};
      renderCart();
      alert('Panier de démonstration chargé.');
    }

    // mise à jour du coût de livraison en temps réel
    document.getElementById('deliveryMethod').addEventListener('change', renderCart);

    // initial render
    renderCart();
  </script>
</body>
</html>
